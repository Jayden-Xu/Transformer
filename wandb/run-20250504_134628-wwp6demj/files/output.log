
Using device: cpu
Downloading data: 100%|███████████████████████████████████████| 5.73M/5.73M [00:01<00:00, 3.91MB/s]
Downloading data files: 100%|████████████████████████████████████████| 1/1 [00:01<00:00,  1.48s/it]
Extracting data files: 100%|████████████████████████████████████████| 1/1 [00:00<00:00, 595.44it/s]

Generating train split: 100%|█████████████████████| 32332/32332 [00:00<00:00, 196848.68 examples/s]
Max length of source sentence: 309
Max length of target sentence: 274
Processing Epoch 00:   0%|                                               | 0/29098 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/app/train_wb.py", line 274, in <module>
    train_model(config)
  File "/app/train_wb.py", line 224, in train_model
    encoder_output = model.encode(encoder_input, encoder_mask) # (B, seq_len, d_model)
  File "/app/model.py", line 199, in encode
    src = self.src_pos(src)
  File "/usr/local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/model.py", line 63, in forward
    x = x + self.pe[:x.size(0), :].require_grad_(False)
AttributeError: 'Tensor' object has no attribute 'require_grad_'